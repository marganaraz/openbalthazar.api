[{"SourceCode":"// File: @0x/contracts-utils/contracts/src/interfaces/IOwnable.sol\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\ncontract IOwnable {\r\n\r\n    function transferOwnership(address newOwner)\r\n        public;\r\n}\r\n\r\n// File: @0x/contracts-utils/contracts/src/Ownable.sol\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\ncontract Ownable is\r\n    IOwnable\r\n{\r\n    address public owner;\r\n\r\n    constructor ()\r\n        public\r\n    {\r\n        owner = msg.sender;\r\n    }\r\n\r\n    modifier onlyOwner() {\r\n        require(\r\n            msg.sender == owner,\r\n            \u0022ONLY_CONTRACT_OWNER\u0022\r\n        );\r\n        _;\r\n    }\r\n\r\n    function transferOwnership(address newOwner)\r\n        public\r\n        onlyOwner\r\n    {\r\n        if (newOwner != address(0)) {\r\n            owner = newOwner;\r\n        }\r\n    }\r\n}\r\n\r\n// File: contracts/asset-proxy/interfaces/IAuthorizable.sol\r\n\r\n/*\r\n\r\n  Copyright 2018 ZeroEx Intl.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \u0022License\u0022);\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \u0022AS IS\u0022 BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n\r\n*/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\ncontract IAuthorizable is\r\n    IOwnable\r\n{\r\n    /// @dev Authorizes an address.\r\n    /// @param target Address to authorize.\r\n    function addAuthorizedAddress(address target)\r\n        external;\r\n\r\n    /// @dev Removes authorizion of an address.\r\n    /// @param target Address to remove authorization from.\r\n    function removeAuthorizedAddress(address target)\r\n        external;\r\n\r\n    /// @dev Removes authorizion of an address.\r\n    /// @param target Address to remove authorization from.\r\n    /// @param index Index of target in authorities array.\r\n    function removeAuthorizedAddressAtIndex(\r\n        address target,\r\n        uint256 index\r\n    )\r\n        external;\r\n    \r\n    /// @dev Gets all authorized addresses.\r\n    /// @return Array of authorized addresses.\r\n    function getAuthorizedAddresses()\r\n        external\r\n        view\r\n        returns (address[] memory);\r\n}\r\n\r\n// File: contracts/asset-proxy/mixins/MAuthorizable.sol\r\n\r\n/*\r\n\r\n  Copyright 2018 ZeroEx Intl.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \u0022License\u0022);\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \u0022AS IS\u0022 BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n\r\n*/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\ncontract MAuthorizable is\r\n    IAuthorizable\r\n{\r\n    // Event logged when a new address is authorized.\r\n    event AuthorizedAddressAdded(\r\n        address indexed target,\r\n        address indexed caller\r\n    );\r\n\r\n    // Event logged when a currently authorized address is unauthorized.\r\n    event AuthorizedAddressRemoved(\r\n        address indexed target,\r\n        address indexed caller\r\n    );\r\n\r\n    /// @dev Only authorized addresses can invoke functions with this modifier.\r\n    modifier onlyAuthorized { revert(); _; }\r\n}\r\n\r\n// File: contracts/asset-proxy/MixinAuthorizable.sol\r\n\r\n/*\r\n\r\n  Copyright 2018 ZeroEx Intl.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \u0022License\u0022);\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \u0022AS IS\u0022 BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n\r\n*/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\n\r\ncontract MixinAuthorizable is\r\n    Ownable,\r\n    MAuthorizable\r\n{\r\n    /// @dev Only authorized addresses can invoke functions with this modifier.\r\n    modifier onlyAuthorized {\r\n        require(\r\n            authorized[msg.sender],\r\n            \u0022SENDER_NOT_AUTHORIZED\u0022\r\n        );\r\n        _;\r\n    }\r\n\r\n    mapping (address =\u003E bool) public authorized;\r\n    address[] public authorities;\r\n\r\n    /// @dev Authorizes an address.\r\n    /// @param target Address to authorize.\r\n    function addAuthorizedAddress(address target)\r\n        external\r\n        onlyOwner\r\n    {\r\n        require(\r\n            !authorized[target],\r\n            \u0022TARGET_ALREADY_AUTHORIZED\u0022\r\n        );\r\n\r\n        authorized[target] = true;\r\n        authorities.push(target);\r\n        emit AuthorizedAddressAdded(target, msg.sender);\r\n    }\r\n\r\n    /// @dev Removes authorizion of an address.\r\n    /// @param target Address to remove authorization from.\r\n    function removeAuthorizedAddress(address target)\r\n        external\r\n        onlyOwner\r\n    {\r\n        require(\r\n            authorized[target],\r\n            \u0022TARGET_NOT_AUTHORIZED\u0022\r\n        );\r\n\r\n        delete authorized[target];\r\n        for (uint256 i = 0; i \u003C authorities.length; i\u002B\u002B) {\r\n            if (authorities[i] == target) {\r\n                authorities[i] = authorities[authorities.length - 1];\r\n                authorities.length -= 1;\r\n                break;\r\n            }\r\n        }\r\n        emit AuthorizedAddressRemoved(target, msg.sender);\r\n    }\r\n\r\n    /// @dev Removes authorizion of an address.\r\n    /// @param target Address to remove authorization from.\r\n    /// @param index Index of target in authorities array.\r\n    function removeAuthorizedAddressAtIndex(\r\n        address target,\r\n        uint256 index\r\n    )\r\n        external\r\n        onlyOwner\r\n    {\r\n        require(\r\n            authorized[target],\r\n            \u0022TARGET_NOT_AUTHORIZED\u0022\r\n        );\r\n        require(\r\n            index \u003C authorities.length,\r\n            \u0022INDEX_OUT_OF_BOUNDS\u0022\r\n        );\r\n        require(\r\n            authorities[index] == target,\r\n            \u0022AUTHORIZED_ADDRESS_MISMATCH\u0022\r\n        );\r\n\r\n        delete authorized[target];\r\n        authorities[index] = authorities[authorities.length - 1];\r\n        authorities.length -= 1;\r\n        emit AuthorizedAddressRemoved(target, msg.sender);\r\n    }\r\n\r\n    /// @dev Gets all authorized addresses.\r\n    /// @return Array of authorized addresses.\r\n    function getAuthorizedAddresses()\r\n        external\r\n        view\r\n        returns (address[] memory)\r\n    {\r\n        return authorities;\r\n    }\r\n}\r\n\r\n// File: contracts/asset-proxy/ERC20Proxy.sol\r\n\r\n/*\r\n\r\n  Copyright 2018 ZeroEx Intl.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \u0022License\u0022);\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \u0022AS IS\u0022 BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n\r\n*/\r\n\r\npragma solidity 0.4.24;\r\n\r\n\r\n\r\ncontract ERC20Proxy is\r\n    MixinAuthorizable\r\n{\r\n    // Id of this proxy.\r\n    bytes4 constant internal PROXY_ID = bytes4(keccak256(\u0022ERC20Token(address)\u0022));\r\n    \r\n    // solhint-disable-next-line payable-fallback\r\n    function () \r\n        external\r\n    {\r\n        assembly {\r\n            // The first 4 bytes of calldata holds the function selector\r\n            let selector := and(calldataload(0), 0xffffffff00000000000000000000000000000000000000000000000000000000)\r\n\r\n            // \u0060transferFrom\u0060 will be called with the following parameters:\r\n            // assetData Encoded byte array.\r\n            // from Address to transfer asset from.\r\n            // to Address to transfer asset to.\r\n            // amount Amount of asset to transfer.\r\n            // bytes4(keccak256(\u0022transferFrom(bytes,address,address,uint256)\u0022)) = 0xa85e59e4\r\n            if eq(selector, 0xa85e59e400000000000000000000000000000000000000000000000000000000) {\r\n\r\n                // To lookup a value in a mapping, we load from the storage location keccak256(k, p),\r\n                // where k is the key left padded to 32 bytes and p is the storage slot\r\n                let start := mload(64)\r\n                mstore(start, and(caller, 0xffffffffffffffffffffffffffffffffffffffff))\r\n                mstore(add(start, 32), authorized_slot)\r\n\r\n                // Revert if authorized[msg.sender] == false\r\n                if iszero(sload(keccak256(start, 64))) {\r\n                    // Revert with \u0060Error(\u0022SENDER_NOT_AUTHORIZED\u0022)\u0060\r\n                    mstore(0, 0x08c379a000000000000000000000000000000000000000000000000000000000)\r\n                    mstore(32, 0x0000002000000000000000000000000000000000000000000000000000000000)\r\n                    mstore(64, 0x0000001553454e4445525f4e4f545f415554484f52495a454400000000000000)\r\n                    mstore(96, 0)\r\n                    revert(0, 100)\r\n                }\r\n\r\n                // \u0060transferFrom\u0060.\r\n                // The function is marked \u0060external\u0060, so no abi decodeding is done for\r\n                // us. Instead, we expect the \u0060calldata\u0060 memory to contain the\r\n                // following:\r\n                //\r\n                // | Area     | Offset | Length  | Contents                            |\r\n                // |----------|--------|---------|-------------------------------------|\r\n                // | Header   | 0      | 4       | function selector                   |\r\n                // | Params   |        | 4 * 32  | function parameters:                |\r\n                // |          | 4      |         |   1. offset to assetData (*)        |\r\n                // |          | 36     |         |   2. from                           |\r\n                // |          | 68     |         |   3. to                             |\r\n                // |          | 100    |         |   4. amount                         |\r\n                // | Data     |        |         | assetData:                          |\r\n                // |          | 132    | 32      | assetData Length                    |\r\n                // |          | 164    | **      | assetData Contents                  |\r\n                //\r\n                // (*): offset is computed from start of function parameters, so offset\r\n                //      by an additional 4 bytes in the calldata.\r\n                //\r\n                // (**): see table below to compute length of assetData Contents\r\n                //\r\n                // WARNING: The ABIv2 specification allows additional padding between\r\n                //          the Params and Data section. This will result in a larger\r\n                //          offset to assetData.\r\n\r\n                // Asset data itself is encoded as follows:\r\n                //\r\n                // | Area     | Offset | Length  | Contents                            |\r\n                // |----------|--------|---------|-------------------------------------|\r\n                // | Header   | 0      | 4       | function selector                   |\r\n                // | Params   |        | 1 * 32  | function parameters:                |\r\n                // |          | 4      | 12 \u002B 20 |   1. token address                  |\r\n\r\n                // We construct calldata for the \u0060token.transferFrom\u0060 ABI.\r\n                // The layout of this calldata is in the table below.\r\n                //\r\n                // | Area     | Offset | Length  | Contents                            |\r\n                // |----------|--------|---------|-------------------------------------|\r\n                // | Header   | 0      | 4       | function selector                   |\r\n                // | Params   |        | 3 * 32  | function parameters:                |\r\n                // |          | 4      |         |   1. from                           |\r\n                // |          | 36     |         |   2. to                             |\r\n                // |          | 68     |         |   3. amount                         |\r\n\r\n                /////// Read token address from calldata ///////\r\n                // * The token address is stored in \u0060assetData\u0060.\r\n                //\r\n                // * The \u0022offset to assetData\u0022 is stored at offset 4 in the calldata (table 1).\r\n                //   [assetDataOffsetFromParams = calldataload(4)]\r\n                //\r\n                // * Notes that the \u0022offset to assetData\u0022 is relative to the \u0022Params\u0022 area of calldata;\r\n                //   add 4 bytes to account for the length of the \u0022Header\u0022 area (table 1).\r\n                //   [assetDataOffsetFromHeader = assetDataOffsetFromParams \u002B 4]\r\n                //\r\n                // * The \u0022token address\u0022 is offset 32\u002B4=36 bytes into \u0022assetData\u0022 (tables 1 \u0026 2).\r\n                //   [tokenOffset = assetDataOffsetFromHeader \u002B 36 = calldataload(4) \u002B 4 \u002B 36]\r\n                let token := calldataload(add(calldataload(4), 40))\r\n                \r\n                /////// Setup Header Area ///////\r\n                // This area holds the 4-byte \u0060transferFrom\u0060 selector.\r\n                // Any trailing data in transferFromSelector will be\r\n                // overwritten in the next \u0060mstore\u0060 call.\r\n                mstore(0, 0x23b872dd00000000000000000000000000000000000000000000000000000000)\r\n                \r\n                /////// Setup Params Area ///////\r\n                // We copy the fields \u0060from\u0060, \u0060to\u0060 and \u0060amount\u0060 in bulk\r\n                // from our own calldata to the new calldata.\r\n                calldatacopy(4, 36, 96)\r\n\r\n                /////// Call \u0060token.transferFrom\u0060 using the calldata ///////\r\n                let success := call(\r\n                    gas,            // forward all gas\r\n                    token,          // call address of token contract\r\n                    0,              // don\u0027t send any ETH\r\n                    0,              // pointer to start of input\r\n                    100,            // length of input\r\n                    0,              // write output over input\r\n                    32              // output size should be 32 bytes\r\n                )\r\n\r\n                /////// Check return data. ///////\r\n                // If there is no return data, we assume the token incorrectly\r\n                // does not return a bool. In this case we expect it to revert\r\n                // on failure, which was handled above.\r\n                // If the token does return data, we require that it is a single\r\n                // nonzero 32 bytes value.\r\n                // So the transfer succeeded if the call succeeded and either\r\n                // returned nothing, or returned a non-zero 32 byte value. \r\n                success := and(success, or(\r\n                    iszero(returndatasize),\r\n                    and(\r\n                        eq(returndatasize, 32),\r\n                        gt(mload(0), 0)\r\n                    )\r\n                ))\r\n                if success {\r\n                    return(0, 0)\r\n                }\r\n                \r\n                // Revert with \u0060Error(\u0022TRANSFER_FAILED\u0022)\u0060\r\n                mstore(0, 0x08c379a000000000000000000000000000000000000000000000000000000000)\r\n                mstore(32, 0x0000002000000000000000000000000000000000000000000000000000000000)\r\n                mstore(64, 0x0000000f5452414e534645525f4641494c454400000000000000000000000000)\r\n                mstore(96, 0)\r\n                revert(0, 100)\r\n            }\r\n\r\n            // Revert if undefined function is called\r\n            revert(0, 0)\r\n        }\r\n    }\r\n\r\n    /// @dev Gets the proxy id associated with the proxy address.\r\n    /// @return Proxy id.\r\n    function getProxyId()\r\n        external\r\n        pure\r\n        returns (bytes4)\r\n    {\r\n        return PROXY_ID;\r\n    }\r\n}","ABI":"[{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022name\u0022:\u0022target\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022addAuthorizedAddress\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022authorities\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022name\u0022:\u0022target\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022removeAuthorizedAddress\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022owner\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022name\u0022:\u0022target\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022name\u0022:\u0022index\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022removeAuthorizedAddressAtIndex\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022getProxyId\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bytes4\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022pure\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022authorized\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022getAuthorizedAddresses\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address[]\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022name\u0022:\u0022newOwner\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022transferOwnership\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022fallback\u0022},{\u0022anonymous\u0022:false,\u0022inputs\u0022:[{\u0022indexed\u0022:true,\u0022name\u0022:\u0022target\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022indexed\u0022:true,\u0022name\u0022:\u0022caller\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022AuthorizedAddressAdded\u0022,\u0022type\u0022:\u0022event\u0022},{\u0022anonymous\u0022:false,\u0022inputs\u0022:[{\u0022indexed\u0022:true,\u0022name\u0022:\u0022target\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022indexed\u0022:true,\u0022name\u0022:\u0022caller\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022AuthorizedAddressRemoved\u0022,\u0022type\u0022:\u0022event\u0022}]","ContractName":"ERC20Proxy","CompilerVersion":"v0.4.24\u002Bcommit.e67f0147","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://03e304c1166ae627f76b6ee2d1b50e0948787c58fd5a59349145866f95b30313"}]