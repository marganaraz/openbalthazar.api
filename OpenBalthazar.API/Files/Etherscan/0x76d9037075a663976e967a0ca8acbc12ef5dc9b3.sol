[{"SourceCode":"pragma solidity 0.4.26;\r\n\r\n/* TEMPLATE TERMS\r\n\r\nEstablishing a retainer and acknowledging the mutual consideration and agreement hereby, Client, indentified as ethereum address \u00270x[[Client Ethereum Address]]\u0027,\r\n\r\ncommits a digital payment transactional script capped at \u0027$[[Payment Cap in Dollars]]\u0027 for the benefit of Provider, identified as ethereum address \u00270x[[Provider Ethereum Address]]\u0027,\r\n\r\nin exchange for the prompt satisfaction of the following deliverables to Client by Provider, \u0027[[Deliverable]]\u0027, upon scripted payments set at the rate of \u0027$[[Deliverable Rate]]\u0027 per deliverable,\r\n\r\nwith such retainer relationship not to exceed \u0027[[Retainer Duration in Days]]\u0027 days and to be governed by the choice of [[Choice of Law and Arbitration Forum]] law and \u0027either/or\u0027 arbitration rules in [[Choice of Law and Arbitration Forum]]. \r\n*/\r\n\r\n/* OPENLAW TEMPLATE\r\n\r\nhttps://app.openlaw.io/template/OpenLEX%20-%20Digital%20Dollar%20Retainer%20(DDR)\r\n\r\n*/\r\n\r\n/***************\r\nDDR CONTRACT\r\n***************/\r\n\r\ncontract DigitalDollarRetainer {\r\n\r\nstring public terms; // **terms governing DDR**\r\n\r\n// **ERC-20 Token References**\r\nuint256 private decimalFactor = 10**uint256(18); // **adjusts token payments to wei amount for UX**\r\naddress public daiToken = 0x89d24A6b4CcB1B6fAA2625fE562bDD9a23260359; // **designated ERC-20 token for payments - DAI \u0027digital dollar\u0027**\r\naddress public usdcToken = 0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48; // **designated ERC-20 token for payments - USDC \u0027digital dollar\u0027**\r\n\r\n// **Service Retainer References**\r\naddress public client; // **client ethereum address**\r\naddress public provider; // **ethereum address that receives payments in exchange for goods or services**\r\nstring public deliverable; // **goods or services (deliverable) retained for benefit of ethereum payments**\r\nstring public governingLawandForum; // **choice of law and forum for retainer relationship**\r\nuint8 public retainerDurationinDays; // **duration of retainer in days**\r\nuint8 public deliverableRate; // **rate for retained deliverables in digital dollars**\r\nuint8 public paid; // **amount paid thus far under retainer in digital dollars**\r\nuint8 public payCap; // **retainer payment cap in digital dollars**\r\n\r\nevent Paid(uint256 amount, address indexed); // **triggered on successful payments**\r\n\r\nconstructor(string _terms, address _client, address _provider, string _deliverable, string _governingLawandForum, uint8 _retainerDurationinDays, uint8 _deliverableRate, uint8 _payCap) public {\r\nterms = _terms;\r\nclient = _client;\r\nprovider = _provider;\r\ndeliverable = _deliverable;\r\ngoverningLawandForum = _governingLawandForum;\r\nretainerDurationinDays = _retainerDurationinDays;\r\ndeliverableRate = _deliverableRate;\r\npayCap = _payCap;\r\n}\r\n\r\nfunction getTerms() // **getter function to facilitate factory calls**\r\npublic\r\nview\r\nreturns (string)\r\n{\r\nreturn terms;\r\n}\r\n\r\nfunction payDAI() public { // **forwards approved DAI token amount to provider ethereum address**\r\nrequire(msg.sender == client);\r\nrequire(paid \u003C= payCap, \u0022payDAI: payCap exceeded\u0022);\r\nrequire(paid \u002B deliverableRate \u003C= payCap, \u0022payDAI: payCap exceeded\u0022);\r\nuint256 weiAmount = deliverableRate * decimalFactor;\r\nERC20 dai = ERC20(daiToken);\r\ndai.transferFrom(msg.sender, provider, weiAmount);\r\nemit Paid(weiAmount, msg.sender);\r\npaid = paid \u002B deliverableRate;\r\n}\r\n\r\nfunction payUSDC() public { // **forwards approved USDC token amount to provider ethereum address**\r\nrequire(msg.sender == client);\r\nrequire(paid \u003C= payCap, \u0022payUSDC: payCap exceeded\u0022);\r\nrequire(paid \u002B deliverableRate \u003C= payCap, \u0022payUSDC: payCap exceeded\u0022);\r\nuint256 weiAmount = deliverableRate * decimalFactor;\r\nERC20 usdc = ERC20(usdcToken);\r\nusdc.transferFrom(msg.sender, provider, weiAmount);\r\nemit Paid(weiAmount, msg.sender);\r\npaid = paid \u002B deliverableRate;\r\n}\r\n}\r\n\r\n/***************\r\nERC20 CONTRACT\r\n***************/\r\n\r\n/**\r\n* @title ERC20\r\n* @dev see https://github.com/ethereum/EIPs/issues/20\r\n*/\r\ncontract ERC20 {\r\nuint256 public totalSupply;\r\n\r\nfunction balanceOf(address who) public view returns (uint256);\r\nfunction transfer(address to, uint256 value) public returns (bool);\r\nfunction allowance(address owner, address spender) public view returns (uint256);\r\nfunction transferFrom(address from, address to, uint256 value) public returns (bool);\r\nfunction approve(address spender, uint256 value) public returns (bool);\r\n\r\nevent Approval(address indexed owner, address indexed spender, uint256 value);\r\nevent Transfer(address indexed from, address indexed to, uint256 value);\r\n}\r\n\r\n/***************\r\nFACTORY CONTRACT\r\n***************/\r\n\r\ncontract DigitalDollarRetainerFactory {\r\n\r\n// **index of created contracts**\r\nmapping (address =\u003E bool) public validContracts;\r\naddress[] public contracts;\r\n\r\n// **useful to know the row count in contracts index**\r\nfunction getContractCount()\r\npublic\r\nview\r\nreturns(uint contractCount)\r\n{\r\nreturn contracts.length;\r\n}\r\n\r\n// **get all contracts**\r\nfunction getDeployedContracts() public view returns (address[])\r\n{\r\nreturn contracts;\r\n}\r\n\r\n// **deploy a new contract**\r\nfunction newDigitalRetainer(string _terms, address _client, address _provider, string _deliverable, string _governingLawandForum, uint8 _retainerDurationinDays, uint8 _deliverableRate, uint8 _payCap)\r\npublic\r\nreturns(address)\r\n{\r\nDigitalDollarRetainer c = new DigitalDollarRetainer(_terms, _client, _provider, _deliverable, _governingLawandForum, _retainerDurationinDays, _deliverableRate, _payCap);\r\nvalidContracts[c] = true;\r\ncontracts.push(c);\r\nreturn c;\r\n}\r\n\r\n// **retrieve stored terms from deployed DDR**\r\nfunction getTerms(address ddRetainer)\r\npublic\r\nview\r\nreturns(string)\r\n{\r\n\r\n// **ensure valid address for DDR**\r\nrequire(validContracts[ddRetainer],\u0022Contract Not Found!\u0022);\r\n\r\nreturn (DigitalDollarRetainer(ddRetainer).getTerms());\r\n}\r\n}","ABI":"[{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022ddRetainer\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022getTerms\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022string\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022contracts\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022validContracts\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022getContractCount\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022contractCount\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022getDeployedContracts\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address[]\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022name\u0022:\u0022_terms\u0022,\u0022type\u0022:\u0022string\u0022},{\u0022name\u0022:\u0022_client\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022name\u0022:\u0022_provider\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022name\u0022:\u0022_deliverable\u0022,\u0022type\u0022:\u0022string\u0022},{\u0022name\u0022:\u0022_governingLawandForum\u0022,\u0022type\u0022:\u0022string\u0022},{\u0022name\u0022:\u0022_retainerDurationinDays\u0022,\u0022type\u0022:\u0022uint8\u0022},{\u0022name\u0022:\u0022_deliverableRate\u0022,\u0022type\u0022:\u0022uint8\u0022},{\u0022name\u0022:\u0022_payCap\u0022,\u0022type\u0022:\u0022uint8\u0022}],\u0022name\u0022:\u0022newDigitalRetainer\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022}]","ContractName":"DigitalDollarRetainerFactory","CompilerVersion":"v0.4.26\u002Bcommit.4563c3fc","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://5d8e3c3ffb3ca941a565d8ca43d3b3a3937ac1360d04ea4f141f0210f99d3e3d"}]