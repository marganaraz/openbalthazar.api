[{"SourceCode":"pragma solidity ^0.5.12;\r\n\r\n// EtherBuy is a DApp to buy and sell anything on Ethereum.\r\ncontract EtherBuy {\r\n\tstruct oneSale {\r\n\t\taddress payable seller;\r\n\t\tstring title;\r\n\t\tstring content;\r\n\t\tuint price;\r\n\t\tuint locked; //money will be locked until the buyer sends feedback or the seller cancels sale\r\n\t\tbool available;\r\n\t}\r\n\tstruct oneBuy {\r\n\t\taddress payable buyer;\r\n\t\tstring message;\r\n\t\tbool lockReleased;\r\n\t\tbool hasReceived;\r\n\t\tstring commentByBuyer;\r\n\t\tstring commentBySeller;\r\n\t}\r\n\t\r\n\toneSale[] public sales;\r\n\tmapping(uint =\u003E oneBuy[]) public buys;\r\n\r\n\tevent SellEvent();\r\n\tevent BuyEvent(uint SaleID, string message);\r\n\tevent CancelEvent(uint SaleID);\r\n\tevent FeedbackEvent(uint SaleID, uint BuyID);\r\n\r\n\tfunction sell(string memory title, string memory content, uint price, uint locked) public {\r\n\t\tsales.push(oneSale(\r\n\t\t\tmsg.sender,\r\n\t\t\ttitle,\r\n\t\t\tcontent,\r\n\t\t\tprice,\r\n\t\t\tlocked,\r\n\t\t\ttrue\r\n\t\t));\t\t\r\n\t\temit SellEvent();\r\n\t}\r\n\r\n\tfunction buy(uint SaleID, string memory message) public payable {\r\n\t\trequire(sales[SaleID].available);\r\n\t\trequire(msg.value==sales[SaleID].price\u002Bsales[SaleID].locked);\r\n\r\n\t\tbuys[SaleID].push(oneBuy(\r\n\t\t\tmsg.sender,\r\n\t\t\tmessage,\r\n\t\t\tfalse,\r\n\t\t\tfalse,\r\n\t\t\t\u0022\u0022,\r\n\t\t\t\u0022\u0022\r\n\t\t));\r\n\r\n\t\tsales[SaleID].seller.transfer(sales[SaleID].price);\r\n\t\t\r\n\t\temit BuyEvent(SaleID, message);\r\n\t}\r\n\r\n\tfunction cancel(uint SaleID) public {\r\n\t\trequire(msg.sender==sales[SaleID].seller);\r\n\t\tsales[SaleID].available = false;\r\n\t\tif(sales[SaleID].locked\u003E0) {\r\n\t\t\tuint lockedValue = sales[SaleID].locked;\r\n\t\t\tfor (uint BuyID=0; BuyID\u003Cbuys[SaleID].length; BuyID\u002B\u002B) {\r\n\t\t\t\tif(buys[SaleID][BuyID].lockReleased==false) {\r\n\t\t\t\t\tbuys[SaleID][BuyID].lockReleased = true;\r\n\t\t\t\t\tbuys[SaleID][BuyID].buyer.transfer(lockedValue);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\temit CancelEvent(SaleID);\r\n\t}\r\n\r\n\tfunction buyerFeedback(uint SaleID, uint BuyID, bool hasReceived, string memory comment) public {\r\n\t\trequire(msg.sender==buys[SaleID][BuyID].buyer);\r\n\r\n\t\tif(!buys[SaleID][BuyID].lockReleased \u0026\u0026 sales[SaleID].locked\u003E0) {\r\n\t\t\tbuys[SaleID][BuyID].lockReleased = true;\r\n\t\t\tmsg.sender.transfer(sales[SaleID].locked);\r\n\t\t}\r\n\r\n\t\tbuys[SaleID][BuyID].hasReceived = hasReceived;\r\n\t\tbuys[SaleID][BuyID].commentByBuyer = comment;\r\n\t\temit FeedbackEvent(SaleID, BuyID);\r\n\t}\r\n\r\n\tfunction sellerFeedback(uint SaleID, uint BuyID, string memory comment) public {\r\n\t\trequire(msg.sender==sales[SaleID].seller);\r\n\t\tbuys[SaleID][BuyID].commentBySeller = comment;\r\n\t\temit FeedbackEvent(SaleID, BuyID);\r\n\t}\r\n\r\n    function getCountOfSales() view public returns (uint) {\r\n    \treturn sales.length;\r\n    }\r\n    \r\n    function getCountOfBuys(uint SaleID) view public returns (uint) {\r\n    \treturn buys[SaleID].length;\r\n    }\r\n}","ABI":"[{\u0022anonymous\u0022:false,\u0022inputs\u0022:[{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022SaleID\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022message\u0022,\u0022type\u0022:\u0022string\u0022}],\u0022name\u0022:\u0022BuyEvent\u0022,\u0022type\u0022:\u0022event\u0022},{\u0022anonymous\u0022:false,\u0022inputs\u0022:[{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022SaleID\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022CancelEvent\u0022,\u0022type\u0022:\u0022event\u0022},{\u0022anonymous\u0022:false,\u0022inputs\u0022:[{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022SaleID\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022BuyID\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022FeedbackEvent\u0022,\u0022type\u0022:\u0022event\u0022},{\u0022anonymous\u0022:false,\u0022inputs\u0022:[],\u0022name\u0022:\u0022SellEvent\u0022,\u0022type\u0022:\u0022event\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022SaleID\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022message\u0022,\u0022type\u0022:\u0022string\u0022}],\u0022name\u0022:\u0022buy\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:true,\u0022stateMutability\u0022:\u0022payable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022SaleID\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022BuyID\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022hasReceived\u0022,\u0022type\u0022:\u0022bool\u0022},{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022comment\u0022,\u0022type\u0022:\u0022string\u0022}],\u0022name\u0022:\u0022buyerFeedback\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022buys\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022address payable\u0022,\u0022name\u0022:\u0022buyer\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022message\u0022,\u0022type\u0022:\u0022string\u0022},{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022lockReleased\u0022,\u0022type\u0022:\u0022bool\u0022},{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022hasReceived\u0022,\u0022type\u0022:\u0022bool\u0022},{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022commentByBuyer\u0022,\u0022type\u0022:\u0022string\u0022},{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022commentBySeller\u0022,\u0022type\u0022:\u0022string\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022SaleID\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022cancel\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022SaleID\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022getCountOfBuys\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022getCountOfSales\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022sales\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022address payable\u0022,\u0022name\u0022:\u0022seller\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022title\u0022,\u0022type\u0022:\u0022string\u0022},{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022content\u0022,\u0022type\u0022:\u0022string\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022price\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022locked\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022available\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022title\u0022,\u0022type\u0022:\u0022string\u0022},{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022content\u0022,\u0022type\u0022:\u0022string\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022price\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022locked\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022sell\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022SaleID\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022BuyID\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022string\u0022,\u0022name\u0022:\u0022comment\u0022,\u0022type\u0022:\u0022string\u0022}],\u0022name\u0022:\u0022sellerFeedback\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022}]","ContractName":"EtherBuy","CompilerVersion":"v0.5.12\u002Bcommit.7709ece9","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://557b3b504cbadcf0435a5e043fb45bd30db60c231cc51a5ccfb098e130d133a8"}]