[{"SourceCode":"pragma solidity ^0.5.16;\r\n\r\nlibrary SafeMath {\r\n    function mul(uint256 a, uint256 b) internal pure returns (uint256 c) {\r\n        if (a == 0) {\r\n            return 0;\r\n        }\r\n        c = a * b;\r\n        assert(c / a == b);\r\n        return c;\r\n    }\r\n\r\n    function div(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        return a / b;\r\n    }\r\n\r\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        assert(b \u003C= a);\r\n        return a - b;\r\n    }\r\n\r\n    function add(uint256 a, uint256 b) internal pure returns (uint256 c) {\r\n        c = a \u002B b;\r\n        assert(c \u003E= a);\r\n        return c;\r\n    }\r\n}\r\n\r\ncontract Ownable {\r\n    address public owner;\r\n    address public newOwner;\r\n\r\n    event OwnershipTransferred(address indexed oldOwner, address indexed newOwner);\r\n\r\n    modifier onlyOwner() {\r\n        require(msg.sender == owner, \u0022msg.sender == owner\u0022);\r\n        _;\r\n    }\r\n\r\n    function transferOwnership(address _newOwner) public onlyOwner {\r\n        require(address(0) != _newOwner, \u0022address(0) != _newOwner\u0022);\r\n        newOwner = _newOwner;\r\n    }\r\n\r\n    function acceptOwnership() public {\r\n        require(msg.sender == newOwner, \u0022msg.sender == newOwner\u0022);\r\n        emit OwnershipTransferred(owner, msg.sender);\r\n        owner = msg.sender;\r\n        newOwner = address(0);\r\n    }\r\n}\r\n\r\ncontract Adminable is Ownable {\r\n    mapping(address =\u003E bool) public admins;\r\n\r\n    modifier onlyAdmin() {\r\n        require(admins[msg.sender] \u0026\u0026 msg.sender != owner, \u0022admins[msg.sender] \u0026\u0026 msg.sender != owner\u0022);\r\n        _;\r\n    }\r\n\r\n    function setAdmin(address _admin, bool _authorization) public onlyOwner {\r\n        admins[_admin] = _authorization;\r\n    }\r\n\r\n}\r\n\r\n\r\ncontract Token {\r\n    function transfer(address _to, uint256 _value) public returns (bool success);\r\n    function approveAndCall(address _spender, uint256 _value, bytes memory _extraData) public returns (bool success);\r\n    function approve(address _spender, uint256 _value) public returns (bool success);\r\n    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\r\n    uint8 public decimals;\r\n}\r\n\r\ncontract Dex is Ownable, Adminable {\r\n    using SafeMath for uint256;\r\n\r\n    mapping (address =\u003E uint256) public invalidOrder;\r\n\r\n    function invalidateOrdersBefore(address _user) public onlyAdmin {\r\n        require(now \u003E invalidOrder[_user], \u0022now \u003E invalidOrder[_user]\u0022);\r\n        invalidOrder[_user] = now;\r\n    }\r\n\r\n    mapping (address =\u003E mapping (address =\u003E uint256)) public tokens; //mapping of token addresses to mapping of account balances\r\n\r\n    mapping (address =\u003E uint256) public lastActiveTransaction; // time of last interaction with this contract\r\n    mapping (bytes32 =\u003E uint256) public orderFills; //balanceOf order filled\r\n\r\n    address public feeAccount;\r\n    uint256 public inactivityReleasePeriod;\r\n\r\n    mapping (bytes32 =\u003E bool) public hashed; //hashes of: order already traded \u0026\u0026 funds already hashed \u0026\u0026 accounts updated\r\n\r\n    uint256 public maxFeeWithdrawal;\r\n    uint256 public maxFeeTrade;\r\n\r\n    address public dexToken;\r\n    uint256 public dexTokenFeeDiscount;\r\n\r\n    mapping (address =\u003E bool) public baseCurrency;\r\n\r\n    bool internal initialized = true;\r\n    function init(address _feeAccount, address _dexToken, uint256 _dexTokenFeeDiscount, address _admin) public {\r\n        require(!initialized, \u0022!initialized\u0022);\r\n        initialized = true;\r\n\r\n        feeAccount = _feeAccount;\r\n        dexToken = _dexToken;\r\n        dexTokenFeeDiscount = _dexTokenFeeDiscount;\r\n\r\n        inactivityReleasePeriod = 2 weeks;\r\n        maxFeeWithdrawal = 0.05 ether; // max fee rate applied = 5%\r\n        maxFeeTrade = 0.10 ether; // max fee rate applied = 10%\r\n\r\n        owner = msg.sender;\r\n        admins[_admin] = true;\r\n    }\r\n\r\n\r\n    /***************************\r\n     * EDITABLE CONFINGURATION *\r\n     ***************************/\r\n\r\n    function setInactivityReleasePeriod(uint256 _expiry) public onlyAdmin returns (bool success) {\r\n        require(_expiry \u003C 26 weeks, \u0022_expiry \u003C 26 weeks\u0022);\r\n        inactivityReleasePeriod = _expiry;\r\n        return true;\r\n    }\r\n\r\n    function setFeeAccount(address _newFeeAccount) public onlyOwner returns (bool success) {\r\n        feeAccount = _newFeeAccount;\r\n        success = true;\r\n    }\r\n\r\n    function setDexToken(address _dexToken) public onlyOwner returns (bool success) {\r\n        dexToken = _dexToken;\r\n        success = true;\r\n    }\r\n\r\n    function setDexTokenFeeDiscount(uint256 _dexTokenFeeDiscount) public onlyOwner returns (bool success) {\r\n        dexTokenFeeDiscount = _dexTokenFeeDiscount;\r\n        success = true;\r\n    }\r\n\r\n    function setBaseCurrency (address _baseCurrency, bool _boolean) public onlyOwner returns (bool success) {\r\n        baseCurrency[_baseCurrency] = _boolean;\r\n        success = true;\r\n    }\r\n\r\n    /***************************\r\n     * UPDATE ACCOUNT ACTIVITY *\r\n     ***************************/\r\n    function updateAccountActivity() public {\r\n        lastActiveTransaction[msg.sender] = now;\r\n    }\r\n\r\n    function adminUpdateAccountActivity(address _user, uint256 _expiry, uint8 _v, bytes32 _r, bytes32 _s)\r\n    public onlyAdmin returns(bool success) {\r\n        require(now \u003C _expiry, \u0022should be: now \u003C _expiry\u0022);\r\n        bytes32 hash = keccak256(abi.encodePacked(this, _user, _expiry));\r\n        require(!hashed[hash], \u0022!hashed[hash]\u0022);\r\n        hashed[hash] = true;\r\n\r\n        require(ecrecover(keccak256(abi.encodePacked(\u0022\\x19Ethereum Signed Message:\\n32\u0022, hash)), _v, _r, _s) == _user,\u0022invalid update account activity signature\u0022);\r\n\r\n        lastActiveTransaction[_user] = now;\r\n        success = true;\r\n    }\r\n\r\n    /*****************\r\n     * DEPOSIT TOKEN *\r\n     *****************/\r\n    event Deposit(address token, address user, uint256 amount, uint256 balance);\r\n\r\n    function tokenFallback(address _from, uint256 _amount, bytes memory) public returns(bool) {\r\n        depositTokenFunction(msg.sender, _amount, _from);\r\n        return true;\r\n    }\r\n\r\n    function receiveApproval(address _from, uint256 _amount, bytes memory) public returns(bool) {\r\n        transferFromAndDepositTokenFunction(msg.sender, _amount, _from, _from);\r\n        return true;\r\n    }\r\n\r\n    function depositToken(address _token, uint256 _amount) public returns(bool) {\r\n        transferFromAndDepositTokenFunction(_token, _amount, msg.sender, msg.sender);\r\n        return true;\r\n    }\r\n\r\n    function depositTokenFor(address _token, uint256 _amount, address _beneficiary) public returns(bool) {\r\n        transferFromAndDepositTokenFunction(_token, _amount, msg.sender, _beneficiary);\r\n        return true;\r\n    }\r\n\r\n    function transferFromAndDepositTokenFunction (address _token, uint256 _amount, address _sender, address _beneficiary) private {\r\n        require(Token(_token).transferFrom(_sender, address(this), _amount), \u0022Token(_token).transferFrom(_sender, this, _amount)\u0022);\r\n        depositTokenFunction(_token, _amount, _beneficiary);\r\n    }\r\n\r\n    function depositTokenFunction(address _token, uint256 _amount, address _beneficiary) private {\r\n        tokens[_token][_beneficiary] = tokens[_token][_beneficiary].add(_amount);\r\n\r\n        if(tx.origin == _beneficiary) lastActiveTransaction[tx.origin] = now;\r\n\r\n        emit Deposit(_token, _beneficiary, _amount, tokens[_token][_beneficiary]);\r\n    }\r\n\r\n    /*****************\r\n     * DEPOSIT ETHER *\r\n     *****************/\r\n\r\n    function depositEther() public payable {\r\n        depositEtherFor(msg.sender);\r\n    }\r\n\r\n    function depositEtherFor(address _beneficiary) public payable {\r\n        tokens[address(0)][_beneficiary] = tokens[address(0)][_beneficiary].add(msg.value);\r\n\r\n        if(msg.sender == _beneficiary) lastActiveTransaction[msg.sender] = now;\r\n\r\n        emit Deposit(address(0), _beneficiary, msg.value, tokens[address(0)][_beneficiary]);\r\n    }\r\n\r\n    /************\r\n     * WITHDRAW *\r\n     ************/\r\n    event EmergencyWithdraw(address token, address user, uint256 amount, uint256 balance);\r\n\r\n    function emergencyWithdraw(address _token, uint256 _amount) public returns (bool success) {\r\n\r\n        require(now.sub(lastActiveTransaction[msg.sender]) \u003E inactivityReleasePeriod, \u0022now.sub(lastActiveTransaction[msg.sender]) \u003E inactivityReleasePeriod\u0022);\r\n        require(tokens[_token][msg.sender] \u003E= _amount, \u0022not enough balance for withdrawal\u0022);\r\n\r\n        tokens[_token][msg.sender] = tokens[_token][msg.sender].sub(_amount);\r\n\r\n        if (_token == address(0)) {\r\n            require(msg.sender.send(_amount), \u0022msg.sender.send(_amount)\u0022);\r\n        } else {\r\n            require(Token(_token).transfer(msg.sender, _amount), \u0022Token(_token).transfer(msg.sender, _amount)\u0022);\r\n        }\r\n\r\n        emit EmergencyWithdraw(_token, msg.sender, _amount, tokens[_token][msg.sender]);\r\n        success = true;\r\n    }\r\n\r\n    event Withdraw(address token, address user, uint256 amount, uint256 balance);\r\n\r\n    function adminWithdraw(address _token, uint256 _amount, address payable _user, uint256 _nonce, uint8 _v, bytes32[2] memory _rs, uint256[2] memory _fee) public onlyAdmin returns (bool success) {\r\n\r\n         /*_fee\r\n                [0] _feeWithdrawal\r\n                [1] _payWithDexToken (yes is 1 - no is 0)\r\n            _rs\r\n                [0] _r\r\n                [1] _s\r\n         */\r\n\r\n\r\n        bytes32 hash = keccak256(abi.encodePacked(this, _fee[1], _token, _amount, _user, _nonce));\r\n        require(!hashed[hash], \u0022!hashed[hash]\u0022);\r\n        hashed[hash] = true;\r\n\r\n        require(ecrecover(keccak256(abi.encodePacked(\u0022\\x19Ethereum Signed Message:\\n32\u0022, hash)), _v, _rs[0], _rs[1]) == _user, \u0022invalid withdraw signature\u0022);\r\n\r\n        require(tokens[_token][_user] \u003E= _amount, \u0022not enough balance for withdrawal\u0022);\r\n\r\n        tokens[_token][_user] = tokens[_token][_user].sub(_amount);\r\n\r\n        uint256 fee;\r\n        if (_fee[1] == 1) fee = toWei(_amount, _token).mul(_fee[0]) / 1 ether;\r\n        if (_fee[1] == 1 \u0026\u0026 tokens[dexToken][_user] \u003E= fee) {\r\n            tokens[dexToken][feeAccount] = tokens[dexToken][feeAccount].add(fee);\r\n            tokens[dexToken][_user] = tokens[dexToken][_user].sub(fee);\r\n        } else {\r\n            if (_fee[0] \u003E maxFeeWithdrawal) _fee[0] = maxFeeWithdrawal;\r\n\r\n            fee = _fee[0].mul(_amount) / 1 ether;\r\n            tokens[_token][feeAccount] = tokens[_token][feeAccount].add(fee);\r\n            _amount = _amount.sub(fee);\r\n        }\r\n\r\n        if (_token == address(0)) {\r\n            require(_user.send(_amount), \u0022_user.send(_amount)\u0022);\r\n        } else {\r\n            require(Token(_token).transfer(_user, _amount), \u0022Token(_token).transfer(_user, _amount)\u0022);\r\n        }\r\n\r\n        lastActiveTransaction[_user] = now;\r\n\r\n        emit Withdraw(_token, _user, _amount, tokens[_token][_user]);\r\n        success = true;\r\n  }\r\n\r\n    function balanceOf(address _token, address _user) public view returns (uint256) {\r\n        return tokens[_token][_user];\r\n    }\r\n\r\n\r\n    /***************\r\n     * ADMIN TRADE *\r\n     ***************/\r\n\r\n    function adminTrade(uint256[] memory _values, address[] memory _addresses, uint8[] memory _v, bytes32[] memory _rs) public onlyAdmin returns (bool success) {\r\n        /* amountSellTaker is in amountBuyMaker terms\r\n         _values\r\n            [0] amountSellTaker\r\n            [1] tradeNonceTaker\r\n            [2] feeTake\r\n            [3] dexTokenPrice\r\n            [4] feePayableDexTokenTaker (yes is 1 - no is 0)\r\n            [5] feeMake\r\n            [i*5\u002B6] amountBuyMaker\r\n            [i*5\u002B7] amountSellMaker\r\n            [i*5\u002B8] expiresMaker\r\n            [i*5\u002B9] nonceMaker\r\n            [i*5\u002B10] feePayableDexTokenMaker (yes is 1 - no is 0)\r\n         _addresses\r\n            [0] tokenBuyAddress\r\n            [1] tokenSellAddress\r\n            [2] takerAddress\r\n            [i\u002B3] makerAddress\r\n         _v\r\n            [0] vTaker\r\n            [i\u002B1] vMaker\r\n         _rs\r\n            [0] rTaker\r\n            [1] sTaker\r\n            [i*2\u002B2] rMaker\r\n            [i*2\u002B3] sMaker\r\n         */\r\n\r\n\r\n        /**********************\r\n         * FEE SECURITY CHECK *\r\n         **********************/\r\n\r\n        //if (feeTake \u003E maxFeeTrade) feeTake = maxFeeTrade;\r\n        if (_values[2] \u003E maxFeeTrade) _values[2] = maxFeeTrade;    // set max fee take\r\n\r\n        // if (feeMake \u003E maxFeeTrade) feeMake = maxFeeTrade;\r\n        if (_values[5] \u003E maxFeeTrade) _values[5] = maxFeeTrade;    // set max fee make\r\n\r\n        /********************************\r\n         * TAKER BEFORE SECURITY CHECK *\r\n         ********************************/\r\n\r\n        //check if there are sufficient funds for TAKER:\r\n        require(tokens[_addresses[0]][_addresses[2]] \u003E= _values[0],\r\n                \u0022tokens[tokenBuyAddress][takerAddress] \u003E= amountSellTaker\u0022);\r\n\r\n        /**************\r\n         * LOOP LOGIC *\r\n         **************/\r\n\r\n        bytes32[2] memory orderHash;\r\n        uint256[8] memory amount;\r\n        /*\r\n            orderHash\r\n                [0] globalHash\r\n                [1] makerHash\r\n            amount\r\n                [0] totalBuyMakerAmount\r\n                [1] appliedAmountSellTaker\r\n                [2] remainingAmountSellTaker\r\n                 * [3] amountFeeMake\r\n                 * [4] amountFeeTake\r\n                 * [5] priceTrade\r\n                 * [6] feeDexTokenMaker\r\n                 * [7] feeDexTokenTaker\r\n\r\n        */\r\n\r\n        // remainingAmountSellTaker = amountSellTaker\r\n        amount[2] = _values[0];\r\n\r\n        for(uint256 i=0; i \u003C (_values.length - 6) / 5; i\u002B\u002B) {\r\n\r\n            /************************\r\n             * MAKER SECURITY CHECK *\r\n             *************************/\r\n\r\n            //required: nonceMaker is greater or egual makerAddress\r\n            require(_values[i*5\u002B9] \u003E= invalidOrder[_addresses[i\u002B3]],\r\n                    \u0022nonceMaker \u003E= invalidOrder[makerAddress]\u0022 );\r\n\r\n            // orderHash: ExchangeAddress, tokenBuyAddress, amountBuyMaker, tokenSellAddress, amountSellMaker, expiresMaker, nonceMaker, makerAddress, feePayableDexTokenMaker\r\n            orderHash[1] =  keccak256(abi.encodePacked(abi.encodePacked(this, _addresses[0], _values[i*5\u002B6], _addresses[1], _values[i*5\u002B7], _values[i*5\u002B8], _values[i*5\u002B9], _addresses[i\u002B3]), _values[i*5\u002B10]));\r\n\r\n            //globalHash = keccak256(abi.encodePacked(globalHash, makerHash));\r\n            orderHash[0] = keccak256(abi.encodePacked(orderHash[0], orderHash[1]));\r\n\r\n            //required: the signer is the same address of makerAddress\r\n            require(_addresses[i\u002B3] == ecrecover(keccak256(abi.encodePacked(\u0022\\x19Ethereum Signed Message:\\n32\u0022, orderHash[1])), _v[i\u002B1], _rs[i*2\u002B2], _rs[i*2\u002B3]),\r\n                    \u0027makerAddress    == ecrecover(keccak256(abi.encodePacked(\u0022\\x19Ethereum Signed Message:\\n32\u0022, makerHash  )), vMaker, rMaker   , sMaker   )\u0027);\r\n\r\n\r\n            /*****************\r\n             * GLOBAL AMOUNT *\r\n             *****************/\r\n\r\n            //appliedAmountSellTaker = amountBuyMaker.sub(orderFilled)\r\n            amount[1] = _values[i*5\u002B6].sub(orderFills[orderHash[1]]);\r\n\r\n            //if remainingAmountSellTaker \u003C appliedAmountSellTaker\r\n            if (amount[2] \u003C amount[1]) {\r\n                //appliedAmountSellTaker = remainingAmountSellTaker\r\n                amount[1] = amount[2];\r\n            }\r\n\r\n            //remainingAmountSellTaker -= appliedAmountSellTaker\r\n            amount[2] = amount[2].sub(amount[1]);\r\n\r\n            //totalBuyMakerAmount \u002B= appliedAmountSellTaker\r\n            amount[0] = amount[0].add(amount[1]);\r\n\r\n\r\n            /******************************\r\n             * MAKER SECURITY CHECK FUNDS *\r\n             ******************************/\r\n\r\n            //check if there are sufficient funds for MAKER: tokens[tokenSellAddress][makerAddress] \u003E= amountSellMaker * appliedAmountSellTaker / amountBuyMaker\r\n            require(tokens[_addresses[1]][_addresses[i\u002B3]] \u003E= (_values[i*5\u002B7].mul(amount[1]).div(_values[i*5\u002B6])),\r\n                    \u0022tokens[tokenSellAddress][makerAddress] \u003E= (amountSellMaker.mul(appliedAmountSellTaker).div(amountBuyMaker))\u0022);\r\n\r\n\r\n            /*******************\r\n             * FEE COMPUTATION *\r\n             *******************/\r\n\r\n            /* amount\r\n                 * [3] amountFeeMake\r\n                 * [4] amountFeeTake\r\n                 * [5] priceTrade\r\n                 * [6] feeDexTokenMaker\r\n                 * [7] feeDexTokenTaker\r\n            */\r\n\r\n            //appliedAmountSellTaker = toWei(appliedAmountSellTaker, tokenBuyAddress);\r\n            amount[1] = toWei(amount[1], _addresses[0]);\r\n\r\n            //amountSellMaker = toWei(amountSellMaker, tokenSellAddress);\r\n            _values[i*5\u002B7] = toWei(_values[i*5\u002B7], _addresses[1]);\r\n\r\n            //amountBuyMaker = toWei(amountBuyMaker, tokenBuyAddress)\r\n            _values[i*5\u002B6] = toWei(_values[i*5\u002B6], _addresses[0]);\r\n\r\n            //amountFeeMake = appliedAmountSellTaker.mul(feeMake).div(1e18)\r\n            amount[3] = amount[1].mul(_values[5]).div(1e18);\r\n            //amountFeeTake = amountSellMaker.mul(feeTake).mul(appliedAmountSellTaker).div(amountBuyMaker) / 1e18;\r\n            amount[4] = _values[i*5\u002B7].mul(_values[2]).mul(amount[1]).div(_values[i*5\u002B6]) / 1e18;\r\n\r\n            //if (tokenBuyAddress == address(0) || (baseCurrency[tokenBuyAddress] \u0026\u0026 !(tokenSellAddress == address(0))) {\r\n            if (_addresses[0] == address(0) || (baseCurrency[_addresses[0]] \u0026\u0026 !(_addresses[1] == address(0)))) { // maker sell order\r\n                //amountBuyMaker is ETH or baseCurrency\r\n                //amountSellMaker is TKN\r\n                //amountFeeMake is ETH or baseCurrency\r\n                //amountFeeTake is TKN\r\n\r\n                //if (feePayableDexTokenMaker == 1) feeDexTokenMaker = amountFeeMake.mul(1e18).div(dexTokenPrice).mul(dexTokenFeeDiscount).div(1e18);\r\n                if (_values[i*5\u002B10] == 1) amount[6] = amount[3].mul(1e18).div(_values[3]).mul(dexTokenFeeDiscount).div(1e18);\r\n\r\n                //if (feePayableDexTokenTaker == 1)\r\n                if (_values[4] == 1) {\r\n                    // priceTrade =  amountBuyMaker.mul(1e18).div(amountSellMaker)\r\n                    amount[5] = _values[i*5\u002B6].mul(1e18).div(_values[i*5\u002B7]); // price is ETH / TKN\r\n                    //feeDexTokenTaker = amountFeeTake.mul(priceTrade).div(dexTokenPrice).mul(dexTokenFeeDiscount).div(1e18);\r\n                    amount[7] = amount[4].mul(amount[5]).div(_values[3]).mul(dexTokenFeeDiscount).div(1e18);\r\n                }\r\n\r\n                //amountFeeTake = fromWei(amountFeeTake, tokenSellAddress);\r\n                amount[4] = fromWei(amount[4], _addresses[1]);\r\n\r\n            } else { //maker buy order\r\n                //amountBuyMaker is TKN\r\n                //amountSellMaker is ETH or baseCurrency\r\n                //amountFeeMake is TKN\r\n                //amountFeeTake is ETH or baseCurrency\r\n\r\n                //if (feePayableDexTokenTaker == 1) feeDexTokenTaker = amountFeeTake.mul(1e18).div(dexTokenPrice).mul(dexTokenFeeDiscount).div(1e18);\r\n                if(_values[4] == 1) amount[7] = amount[4].mul(1e18).div(_values[3]).mul(dexTokenFeeDiscount).div(1e18);\r\n\r\n                //if (feePayableDexTokenMaker == 1)\r\n                if (_values[i*5\u002B10] == 1) {\r\n                    // priceTrade =  amountSellMaker.mul(1e18).div(amountBuyMaker)\r\n                    amount[5] = _values[i*5\u002B7].mul(1e18).div(_values[i*5\u002B6]); // price is ETH / TKN\r\n\r\n                    // feeDexTokenMaker = amountFeeMake.mul(priceTrade).div(dexTokenPrice).mul(dexTokenFeeDiscount).div(1e18);\r\n                    amount[6] = amount[3].mul(amount[5]).div(_values[3]).mul(dexTokenFeeDiscount).div(1e18);\r\n                }\r\n\r\n                //amountFeeMake = fromWei(amountFeeMake, tokenBuyAddress);\r\n                amount[3] = fromWei(amount[3], _addresses[0]);\r\n\r\n            }\r\n\r\n            //appliedAmountSellTaker = fromWei(appliedAmountSellTaker, tokenBuyAddress);\r\n            amount[1] = fromWei(amount[1], _addresses[0]);\r\n\r\n            //amountSellMaker = fromWei(amountSellMaker, tokenSellAddress);\r\n            _values[i*5\u002B7] = fromWei(_values[i*5\u002B7], _addresses[1]);\r\n\r\n            //amountBuyMaker = fromWei(amountBuyMaker, tokenBuyAddress)\r\n            _values[i*5\u002B6] = fromWei(_values[i*5\u002B6], _addresses[0]);\r\n\r\n\r\n            /**********************\r\n             * FEE BALANCE UPDATE *\r\n             **********************/\r\n\r\n            //feePayableDexTokenTaker == 1 \u0026\u0026 tokens[dexToken][takerAddress] \u003E= feeDexTokenTaker\r\n            if (_values[4] == 1 \u0026\u0026 tokens[dexToken][_addresses[2]] \u003E= amount[7] ) {\r\n\r\n                //tokens[dexToken][takerAddress]  = tokens[dexToken][takerAddress].sub(feeDexTokenTaker);\r\n                tokens[dexToken][_addresses[2]] = tokens[dexToken][_addresses[2]].sub(amount[7]);\r\n\r\n                //tokens[dexToken][feeAccount] = tokens[dexToken][feeAccount].add(feeDexTokenTaker);\r\n                tokens[dexToken][feeAccount] = tokens[dexToken][feeAccount].add(amount[7]);\r\n\r\n                //amountFeeTake = 0;\r\n                amount[4] = 0;\r\n            } else {\r\n                //tokens[tokenSellAddress][feeAccount] = tokens[tokenSellAddress][feeAccount].add(amountFeeTake);\r\n                tokens[_addresses[1]][feeAccount] = tokens[_addresses[1]][feeAccount].add(amount[4]);\r\n            }\r\n\r\n            //feePayableDexTokenMaker == 1 \u0026\u0026 tokens[dexToken][makerAddress] \u003E= feeDexTokenMaker\r\n            if (_values[i*5\u002B10] == 1 \u0026\u0026 tokens[dexToken][_addresses[i\u002B3]] \u003E= amount[6]) {\r\n\r\n                //tokens[dexToken][makerAddress] = tokens[dexToken][makerAddress].sub(feeDexTokenMaker);\r\n                tokens[dexToken][_addresses[i\u002B3]] = tokens[dexToken][_addresses[i\u002B3]].sub(amount[6]);\r\n\r\n                //tokens[dexToken][feeAccount] = tokens[dexToken][feeAccount].add(feeDexTokenMaker);\r\n                tokens[dexToken][feeAccount] = tokens[dexToken][feeAccount].add(amount[6]);\r\n\r\n                //amountFeeMake = 0;\r\n                amount[3] = 0;\r\n            } else {\r\n                //tokens[tokenBuyAddress][feeAccount] = tokens[tokenBuyAddress][feeAccount].add(amountFeeMake);\r\n                tokens[_addresses[0]][feeAccount] = tokens[_addresses[0]][feeAccount].add(amount[3]);\r\n            }\r\n\r\n\r\n            /******************\r\n             * BALANCE UPDATE *\r\n             ******************/\r\n\r\n        //tokens[tokenBuyAddress][takerAddress] = tokens[tokenBuyAddress][takerAddress].sub(appliedAmountSellTaker);\r\n        tokens[_addresses[0]][_addresses[2]] = tokens[_addresses[0]][_addresses[2]].sub(amount[1]);\r\n\r\n            //tokens[tokenBuyAddress][makerAddress] = tokens[tokenBuyAddress]][makerAddress].add(appliedAmountSellTaker.sub(amountFeeMake));\r\n            tokens[_addresses[0]][_addresses[i\u002B3]] = tokens[_addresses[0]][_addresses[i\u002B3]].add(amount[1].sub(amount[3]));\r\n\r\n\r\n            //tokens[tokenSellAddress][makerAddress] = tokens[tokenSellAddress][makerAddress].sub(amountSellMaker.mul(appliedAmountSellTaker).div(amountBuyMaker));\r\n            tokens[_addresses[1]][_addresses[i\u002B3]] = tokens[_addresses[1]][_addresses[i\u002B3]].sub(_values[i*5\u002B7].mul(amount[1]).div(_values[i*5\u002B6]));\r\n\r\n        //tokens[tokenSellAddress][takerAddress] = tokens[tokenSellAddress][takerAddress].add(amountSellMaker.mul(appliedAmountSellTaker).div(amountBuyMaker).sub(amountFeeTake));\r\n        tokens[_addresses[1]][_addresses[2]] = tokens[_addresses[1]][_addresses[2]].add(_values[i*5\u002B7].mul(amount[1]).div(_values[i*5\u002B6]).sub(amount[4]));\r\n\r\n\r\n            /***********************\r\n             * UPDATE MAKER STATUS *\r\n             ***********************/\r\n\r\n            //orderFills[orderHash[1]] = orderFills[orderHash[1]].add(appliedAmountSellTaker);\r\n            orderFills[orderHash[1]] = orderFills[orderHash[1]].add(amount[1]);\r\n\r\n            //lastActiveTransaction[makerAddress] = now;\r\n            lastActiveTransaction[_addresses[i\u002B3]] = now;\r\n\r\n        }\r\n\r\n\r\n        /*******************************\r\n         * TAKER AFTER SECURITY CHECK *\r\n         *******************************/\r\n\r\n        // tradeHash:                                   globalHash, amountSellTaker, takerAddress, tradeNonceTaker, feePayableDexTokenTaker\r\n        bytes32 tradeHash = keccak256(abi.encodePacked(orderHash[0], _values[0], _addresses[2], _values[1], _values[4]));\r\n\r\n        //required: the signer is the same address of takerAddress\r\n        require(_addresses[2] == ecrecover(keccak256(abi.encodePacked(\u0022\\x19Ethereum Signed Message:\\n32\u0022, tradeHash)), _v[0], _rs[0], _rs[1]),\r\n                \u0027takerAddress  == ecrecover(keccak256(abi.encodePacked(\u0022\\x19Ethereum Signed Message:\\n32\u0022, tradeHash)), vTaker, rTaker, sTaker)\u0027);\r\n\r\n        //required: the same trade is not done\r\n        require(!hashed[tradeHash], \u0022!hashed[tradeHash] \u0022);\r\n        hashed[tradeHash] = true;\r\n\r\n        //required: totalBuyMakerAmount == amountSellTaker\r\n        require(amount[0] == _values[0], \u0022totalBuyMakerAmount == amountSellTaker\u0022);\r\n\r\n\r\n        /***********************\r\n         * UPDATE TAKER STATUS *\r\n         ***********************/\r\n\r\n        //lastActiveTransaction[takerAddress] = now;\r\n        lastActiveTransaction[_addresses[2]] = now;\r\n\r\n        success = true;\r\n    }\r\n    function toWei(uint256 _number, address _token) internal view returns (uint256) {\r\n        if (_token == address(0)) return _number;\r\n        return _number.mul(1e18).div(10**uint256(Token(_token).decimals()));\r\n    }\r\n    function fromWei(uint256 _number, address _token) internal view returns (uint256) {\r\n        if (_token == address(0)) return _number;\r\n        return _number.mul(10**uint256(Token(_token).decimals())).div(1e18);\r\n    }\r\n}","ABI":"[{\u0022anonymous\u0022:false,\u0022inputs\u0022:[{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022token\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022user\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022amount\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022balance\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022Deposit\u0022,\u0022type\u0022:\u0022event\u0022},{\u0022anonymous\u0022:false,\u0022inputs\u0022:[{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022token\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022user\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022amount\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022balance\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022EmergencyWithdraw\u0022,\u0022type\u0022:\u0022event\u0022},{\u0022anonymous\u0022:false,\u0022inputs\u0022:[{\u0022indexed\u0022:true,\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022oldOwner\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022indexed\u0022:true,\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022newOwner\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022OwnershipTransferred\u0022,\u0022type\u0022:\u0022event\u0022},{\u0022anonymous\u0022:false,\u0022inputs\u0022:[{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022token\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022user\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022amount\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022indexed\u0022:false,\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022balance\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022Withdraw\u0022,\u0022type\u0022:\u0022event\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[],\u0022name\u0022:\u0022acceptOwnership\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256[]\u0022,\u0022name\u0022:\u0022_values\u0022,\u0022type\u0022:\u0022uint256[]\u0022},{\u0022internalType\u0022:\u0022address[]\u0022,\u0022name\u0022:\u0022_addresses\u0022,\u0022type\u0022:\u0022address[]\u0022},{\u0022internalType\u0022:\u0022uint8[]\u0022,\u0022name\u0022:\u0022_v\u0022,\u0022type\u0022:\u0022uint8[]\u0022},{\u0022internalType\u0022:\u0022bytes32[]\u0022,\u0022name\u0022:\u0022_rs\u0022,\u0022type\u0022:\u0022bytes32[]\u0022}],\u0022name\u0022:\u0022adminTrade\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022success\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_user\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_expiry\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022uint8\u0022,\u0022name\u0022:\u0022_v\u0022,\u0022type\u0022:\u0022uint8\u0022},{\u0022internalType\u0022:\u0022bytes32\u0022,\u0022name\u0022:\u0022_r\u0022,\u0022type\u0022:\u0022bytes32\u0022},{\u0022internalType\u0022:\u0022bytes32\u0022,\u0022name\u0022:\u0022_s\u0022,\u0022type\u0022:\u0022bytes32\u0022}],\u0022name\u0022:\u0022adminUpdateAccountActivity\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022success\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_token\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_amount\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022address payable\u0022,\u0022name\u0022:\u0022_user\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_nonce\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022uint8\u0022,\u0022name\u0022:\u0022_v\u0022,\u0022type\u0022:\u0022uint8\u0022},{\u0022internalType\u0022:\u0022bytes32[2]\u0022,\u0022name\u0022:\u0022_rs\u0022,\u0022type\u0022:\u0022bytes32[2]\u0022},{\u0022internalType\u0022:\u0022uint256[2]\u0022,\u0022name\u0022:\u0022_fee\u0022,\u0022type\u0022:\u0022uint256[2]\u0022}],\u0022name\u0022:\u0022adminWithdraw\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022success\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022admins\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_token\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_user\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022balanceOf\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022baseCurrency\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[],\u0022name\u0022:\u0022depositEther\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:true,\u0022stateMutability\u0022:\u0022payable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_beneficiary\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022depositEtherFor\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:true,\u0022stateMutability\u0022:\u0022payable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_token\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_amount\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022depositToken\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_token\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_amount\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_beneficiary\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022depositTokenFor\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022dexToken\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022dexTokenFeeDiscount\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_token\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_amount\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022emergencyWithdraw\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022success\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022feeAccount\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022bytes32\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bytes32\u0022}],\u0022name\u0022:\u0022hashed\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022inactivityReleasePeriod\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_feeAccount\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_dexToken\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_dexTokenFeeDiscount\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_admin\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022init\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022invalidOrder\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_user\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022invalidateOrdersBefore\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022lastActiveTransaction\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022maxFeeTrade\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022maxFeeWithdrawal\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022newOwner\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022bytes32\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bytes32\u0022}],\u0022name\u0022:\u0022orderFills\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022owner\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_from\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_amount\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022bytes\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bytes\u0022}],\u0022name\u0022:\u0022receiveApproval\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_admin\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022_authorization\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022name\u0022:\u0022setAdmin\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_baseCurrency\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022_boolean\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022name\u0022:\u0022setBaseCurrency\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022success\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_dexToken\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022setDexToken\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022success\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_dexTokenFeeDiscount\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022setDexTokenFeeDiscount\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022success\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_newFeeAccount\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022setFeeAccount\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022success\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_expiry\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022setInactivityReleasePeriod\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022success\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_from\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022_amount\u0022,\u0022type\u0022:\u0022uint256\u0022},{\u0022internalType\u0022:\u0022bytes\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bytes\u0022}],\u0022name\u0022:\u0022tokenFallback\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022bool\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022bool\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022},{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022tokens\u0022,\u0022outputs\u0022:[{\u0022internalType\u0022:\u0022uint256\u0022,\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022internalType\u0022:\u0022address\u0022,\u0022name\u0022:\u0022_newOwner\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022transferOwnership\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[],\u0022name\u0022:\u0022updateAccountActivity\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022}]","ContractName":"Dex","CompilerVersion":"v0.5.16\u002Bcommit.9c3226ce","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://8f607fa6e3ad47449b88fe833053471884ecbf733565ea1afabae86af46e4375"}]