[{"SourceCode":"pragma solidity ^0.5.10;\r\n\r\ncontract SafeMath {\r\n  function safeMul(uint a, uint b) internal pure returns (uint) {\r\n    uint c = a * b;\r\n    assert(a == 0 || c / a == b);\r\n    return c;\r\n  }\r\n  function safeSub(uint a, uint b) internal pure returns (uint) {\r\n    assert(b \u003C= a);\r\n    return a - b;\r\n  }\r\n  function safeAdd(uint a, uint b) internal pure returns (uint) {\r\n    uint c = a \u002B b;\r\n    assert(c\u003E=a \u0026\u0026 c\u003E=b);\r\n    return c;\r\n  }\r\n}\r\n\r\ncontract Token {\r\n  function balanceOf(address _owner) public view returns (uint256 balance) {}\r\n  function transfer(address _to, uint256 _value) public returns (bool success) {}\r\n  //function transfer(address _to, uint _value) public;\r\n  function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {}\r\n  //function transferFrom(address from, address to, uint value) public;\r\n}\r\n\r\n\r\ncontract DaiSwap is SafeMath {\r\n    mapping (address =\u003E uint) public daiposit;\r\n    uint public totaldai = 0;\r\n    uint public baseMultiplier = 40;\r\n    uint fee = 997; // 0.3%\r\n    uint constant decOffset = 1e12;\r\n    Token  daiContract = Token(0x89d24A6b4CcB1B6fAA2625fE562bDD9a23260359);\r\n    //Token  usdContract = Token(0xdAC17F958D2ee523a2206206994597C13D831ec7);  // USDT\r\n    Token  usdContract = Token(0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48); // USDC\r\n    //Token   daiContract = Token(0xE888757Fbf1f29B520a80f977DBE52F9AD20d6C9); //Kovan Testnet\r\n    //Token  usdContract = Token(0x3502B803f2a516cD6e9d6E8938b700d78ABF1373); //Kovan Testnet\r\n\r\n    function sharesFromDai(uint dai) public view returns (uint) {\r\n        if (totaldai == 0) return dai; // Initialisation \r\n        uint amt_dai  =  daiContract.balanceOf(address(this));\r\n        return safeMul(dai, totaldai) / amt_dai;\r\n    }\r\n\r\n    function usdAmountFromShares(uint shares) public view returns (uint) {\r\n        if (totaldai == 0) return shares / decOffset; // Initialisation - 1 Dai = 1 Shares\r\n        uint amt_usd = safeMul(usdContract.balanceOf(address(this)), decOffset);\r\n        return (safeMul(shares, amt_usd) / totaldai) / decOffset;\r\n    }\r\n    \r\n    function usdAmountFromDai(uint dai) public view returns (uint) {\r\n        return usdAmountFromShares(sharesFromDai(dai));\r\n    }\r\n    \r\n    function deposit(uint dai) public {\r\n        uint shares = sharesFromDai(dai);\r\n        uint usd = usdAmountFromShares(shares);\r\n        daiposit[msg.sender] = safeAdd(daiposit[msg.sender], shares);\r\n        totaldai             = safeAdd(totaldai, shares);\r\n        daiContract.transferFrom(msg.sender, address(this), dai);\r\n        usdContract.transferFrom(msg.sender, address(this), usd);\r\n    }\r\n    \r\n    function withdraw() public {\r\n        uint dai = safeMul(daiposit[msg.sender],  daiContract.balanceOf(address(this))) / totaldai;\r\n        uint usd = safeMul(daiposit[msg.sender], usdContract.balanceOf(address(this))) / totaldai;\r\n        totaldai = safeSub(totaldai, daiposit[msg.sender]);\r\n        daiposit[msg.sender] = 0;\r\n        daiContract.transfer(msg.sender, dai);\r\n        usdContract.transfer(msg.sender, usd);\r\n    }\r\n    \r\n    function calcSwapForUSD(uint dai) public view returns (uint) {\r\n        uint base    = safeMul(baseMultiplier, totaldai);\r\n        uint amt_dai =         daiContract.balanceOf(address(this));\r\n        uint amt_usd = safeMul(usdContract.balanceOf(address(this)), decOffset);\r\n        uint usd     = safeSub(safeAdd(amt_usd, base), ( safeMul(safeAdd(base, amt_usd), safeAdd(base, amt_dai)) / safeAdd(safeAdd(base, amt_dai), dai)));\r\n        usd = usd / decOffset;\r\n        return safeMul(usd, fee) / 1000;\r\n    }\r\n    \r\n    function swapForUSD(uint dai) public {\r\n        uint usd = calcSwapForUSD(dai);\r\n        daiContract.transferFrom(msg.sender, address(this), dai);\r\n        usdContract.transfer(msg.sender, usd);\r\n    }\r\n    \r\n    function calcSwapForDai(uint usd) public view returns (uint) {\r\n        uint base     = safeMul(baseMultiplier, totaldai);\r\n        uint amt_dai  =         daiContract.balanceOf(address(this));\r\n        uint amt_usd  = safeMul(usdContract.balanceOf(address(this)), decOffset);\r\n        uint dai      = safeSub(safeAdd(amt_dai, base), ( safeMul(safeAdd(base, amt_usd), safeAdd(base, amt_dai)) / safeAdd(safeAdd(base, amt_usd), safeMul(usd, decOffset))));\r\n        return safeMul(dai, fee) / 1000;\r\n    }\r\n    \r\n    function swapForDai(uint usd) public {\r\n        uint dai = calcSwapForDai(usd);\r\n        usdContract.transferFrom(msg.sender, address(this), usd);\r\n        daiContract.transfer(msg.sender, dai);\r\n    }\r\n}","ABI":"[{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022address\u0022}],\u0022name\u0022:\u0022daiposit\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022shares\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022usdAmountFromShares\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[],\u0022name\u0022:\u0022withdraw\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022dai\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022sharesFromDai\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022dai\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022calcSwapForUSD\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022name\u0022:\u0022dai\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022deposit\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022totaldai\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022usd\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022calcSwapForDai\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[{\u0022name\u0022:\u0022dai\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022usdAmountFromDai\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022name\u0022:\u0022usd\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022swapForDai\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:true,\u0022inputs\u0022:[],\u0022name\u0022:\u0022baseMultiplier\u0022,\u0022outputs\u0022:[{\u0022name\u0022:\u0022\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022view\u0022,\u0022type\u0022:\u0022function\u0022},{\u0022constant\u0022:false,\u0022inputs\u0022:[{\u0022name\u0022:\u0022dai\u0022,\u0022type\u0022:\u0022uint256\u0022}],\u0022name\u0022:\u0022swapForUSD\u0022,\u0022outputs\u0022:[],\u0022payable\u0022:false,\u0022stateMutability\u0022:\u0022nonpayable\u0022,\u0022type\u0022:\u0022function\u0022}]","ContractName":"DaiSwap","CompilerVersion":"v0.5.10\u002Bcommit.5a6ea5b1","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://b8e4ce31da93dfa7dcad333f1e6a5329e2595db9100131ba4ef3e2b55885896e"}]